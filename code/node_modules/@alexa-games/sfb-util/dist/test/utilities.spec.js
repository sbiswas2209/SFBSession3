"use strict";
/*
 * Copyright 2018 Amazon.com, Inc. and its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: LicenseRef-.amazon.com.-AmznSL-1.0
 *
 * Licensed under the Amazon Software License (the "License").
 * You may not use this file except in compliance with the License.
 * A copy of the License is located at
 *
 *   http://aws.amazon.com/asl/
 *
 * or in the "license" file accompanying this file. This file is distributed
 * on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const utilities_1 = require("../utilities");
const assert_1 = require("assert");
describe('utilities', () => {
    const ExpectedOutput = 'this is a test';
    const TestReadUtf8FileWithoutBomPath = 'test/testFiles/testReadUtf8FileWithoutBom.txt';
    const TestReadUtf8FileWithBomPath = 'test/testFiles/testReadUtf8FileWithBom.txt';
    it('readUtf8FileExcludingBomSync without bom', () => {
        const output = utilities_1.readUtf8FileExcludingBomSync(TestReadUtf8FileWithoutBomPath);
        assert_1.strict.equal(output, ExpectedOutput);
    });
    it('readUtf8FileExcludingBomSync with bom', () => {
        const output = utilities_1.readUtf8FileExcludingBomSync(TestReadUtf8FileWithBomPath);
        assert_1.strict.equal(output, ExpectedOutput);
    });
    it('readUtf8FileExcludingBom without bom', async () => {
        const output = await utilities_1.readUtf8FileExcludingBom(TestReadUtf8FileWithoutBomPath);
        assert_1.strict.equal(output, ExpectedOutput);
    });
    it('readUtf8FileExcludingBom with bom', async () => {
        const output = await utilities_1.readUtf8FileExcludingBom(TestReadUtf8FileWithBomPath);
        assert_1.strict.equal(output, ExpectedOutput);
    });
    describe('sanitizeCommandLineParameter', () => {
        it('removes double quotes', () => {
            const actual = utilities_1.sanitizeCommandLineParameter('fake" && rm -rf / && echo "');
            assert_1.strict.equal(actual, 'fake && rm -rf / && echo ');
        });
        it('removes single quotes', () => {
            const actual = utilities_1.sanitizeCommandLineParameter("fake' && rm -rf / && echo '");
            assert_1.strict.equal(actual, 'fake && rm -rf / && echo ');
        });
        it('removes line breaks', () => {
            const actual = utilities_1.sanitizeCommandLineParameter('fake\\\r\n" && rm -rf / && echo "');
            assert_1.strict.equal(actual, 'fake && rm -rf / && echo ');
        });
        it('removes environment variable syntax', () => {
            const actual = utilities_1.sanitizeCommandLineParameter('fake" && echo ${MY_SECRET_CREDENTIALS} "');
            assert_1.strict.equal(actual, 'fake && echo MY_SECRET_CREDENTIALS ');
        });
    });
});
//# sourceMappingURL=utilities.spec.js.map